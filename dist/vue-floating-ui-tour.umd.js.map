{"version":3,"file":"vue-floating-ui-tour.umd.js","sources":["../src/core/utils.ts","../src/core/TourController.ts","../src/vue/useTour.ts"],"sourcesContent":["/**\n * Generates a simple unique ID string.\n * @returns\n */\nexport const generateId = (): string => `tour_step_${Math.random().toString(36).substring(2, 9)}`;\n","import {\n    computePosition,\n    autoUpdate,\n    offset as offsetMiddleware,\n    shift,\n    flip,\n    arrow as arrowMiddleware,\n    hide,\n    inline,\n    type Middleware,\n  } from '@floating-ui/dom';\n  import type { TourStepDefinition, TourStep, TourOptions, TourControllerPublic } from './types';\n  import { generateId } from './utils';\n\n  export class TourController implements TourControllerPublic {\n    public steps: TourStep[] = [];\n    public currentStepIndex: number = -1;\n    public isActive: boolean = false;\n\n    private options: Required<TourOptions>;\n    private popoverElement?: HTMLElement;\n    private arrowElement?: HTMLElement;\n    private cleanupFloatingUI?: () => void;\n    private highlightOverlay?: HTMLElement;\n    private originalTargetStyles: Map<HTMLElement, Partial<CSSStyleDeclaration>> = new Map();\n\n    constructor(steps: TourStepDefinition[] = [], options: TourOptions = {}) {\n      this.options = {\n        defaultPlacement: 'bottom',\n        defaultOffset: 10,\n        popoverClass: 'v-tour__popover',\n        arrowClass: 'v-tour__arrow',\n        padding: 8,\n        highlightTarget: true,\n        highlightClass: 'v-tour__highlighted-target',\n        overlayClass: 'v-tour__overlay',\n        overlayColor: 'rgba(0,0,0,0.3)',\n        onTourStart: () => {},\n        onTourEnd: () => {},\n        onStepChange: () => {},\n        renderPopover: this._defaultRenderPopover.bind(this),\n        ...options,\n      };\n      this.defineSteps(steps);\n    }\n\n    private _getTargetElement(target: string | HTMLElement): HTMLElement | null {\n      if (typeof target === 'string') {\n        try {\n          return document.querySelector(target);\n        } catch (e) {\n          console.error(`[TourController] Invalid selector: ${target}`, e);\n          return null;\n        }\n      }\n      return target;\n    }\n\n    private _createOrGetPopover(step: TourStep): HTMLElement | null {\n      const actions = {\n        next: () => this.next(),\n        prev: () => this.prev(),\n        finish: () => this.end(),\n      };\n      const popover = this.options.renderPopover(step, actions, this);\n\n      if (!popover || !(popover instanceof HTMLElement)) {\n        console.error(\"[TourController] renderPopover must return an HTMLElement.\");\n        return null;\n      }\n      this.popoverElement = popover;\n\n      if (!this.popoverElement.isConnected) {\n        document.body.appendChild(this.popoverElement);\n      }\n\n      if (this.options.arrowClass && this.popoverElement.classList.contains(this.options.popoverClass)) {\n          this.arrowElement = this.popoverElement.querySelector<HTMLElement>(`.${this.options.arrowClass}`) || undefined;\n      }\n      return this.popoverElement;\n    }\n\n    private _defaultRenderPopover(\n      step: TourStep,\n      actions: { next: () => void; prev: () => void; finish: () => void }\n    ): HTMLElement {\n\n      let popover = document.getElementById('v-tour-default-popover');\n      if (!popover) {\n          popover = document.createElement('div');\n          popover.id = 'v-tour-default-popover';\n          popover.className = this.options.popoverClass;\n          popover.style.position = 'absolute';\n          popover.style.zIndex = '10002';\n          popover.style.display = 'none';\n      }\n      popover.innerHTML = '';\n\n      if (this.options.arrowClass) {\n        const arrowEl = document.createElement('div');\n        arrowEl.className = this.options.arrowClass;\n        arrowEl.style.position = 'absolute';\n        popover.appendChild(arrowEl);\n        this.arrowElement = arrowEl;\n      } else {\n        this.arrowElement = undefined;\n      }\n\n      if (step.title) {\n        const titleEl = document.createElement('h3');\n        titleEl.className = 'v-tour__title';\n        titleEl.textContent = step.title;\n        popover.appendChild(titleEl);\n      }\n\n      const contentEl = document.createElement('div');\n      contentEl.className = 'v-tour__content';\n      const contentValue = typeof step.content === 'function'\n        ? step.content(step, this.currentStepIndex, this)\n        : step.content;\n      if (typeof contentValue === 'string') {\n          contentEl.innerHTML = contentValue;\n      } else if (contentValue instanceof HTMLElement) {\n          contentEl.appendChild(contentValue);\n      }\n      popover.appendChild(contentEl);\n\n      // Footer & Buttons\n      const footerEl = document.createElement('div');\n      footerEl.className = 'v-tour__footer';\n\n      if (this.currentStepIndex > 0) {\n        const prevButton = document.createElement('button');\n        prevButton.type = 'button';\n        prevButton.textContent = 'Previous';\n        prevButton.className = 'v-tour__button v-tour__button-prev';\n        prevButton.onclick = actions.prev;\n        footerEl.appendChild(prevButton);\n      }\n\n      if (this.currentStepIndex < this.steps.length - 1) {\n        const nextButton = document.createElement('button');\n        nextButton.type = 'button';\n        nextButton.textContent = 'Next';\n        nextButton.className = 'v-tour__button v-tour__button-next';\n        nextButton.onclick = actions.next;\n        footerEl.appendChild(nextButton);\n      }\n\n      const finishButton = document.createElement('button');\n      finishButton.type = 'button';\n      finishButton.textContent = this.currentStepIndex === this.steps.length - 1 ? 'Finish' : 'Close';\n      finishButton.className = 'v-tour__button v-tour__button-finish';\n      finishButton.onclick = actions.finish;\n      footerEl.appendChild(finishButton);\n\n      if (footerEl.hasChildNodes()) {\n          popover.appendChild(footerEl);\n      }\n      return popover;\n    }\n\n    public defineSteps(steps: TourStepDefinition[]) {\n      this.steps = steps.map((s) => ({ ...s, id: s.id || generateId() }));\n      if (this.isActive && this.currentStepIndex >= this.steps.length) {\n        this.end();\n      } else if (this.isActive && this.currentStepIndex !== -1) {\n        this._showStepOnTarget(this.currentStepIndex);\n      }\n    }\n\n    public start(index: number = 0) {\n      if (!this.steps.length) {\n        console.warn('[TourController] No steps defined.');\n        return;\n      }\n      this.isActive = true;\n      this.options.onTourStart(this);\n      const oldStep = this.currentStepIndex !== -1 ? this.steps[this.currentStepIndex] : null;\n      this.currentStepIndex = -1;\n      this._showStepOnTarget(index, oldStep);\n    }\n\n    private async _showStepOnTarget(index: number, oldStepForCallback: TourStep | null = null) {\n      if (index < 0 || index >= this.steps.length) {\n        this.end();\n        return;\n      }\n\n      const previousIndex = this.currentStepIndex;\n      if (previousIndex !== -1 && previousIndex !== index) {\n        await this._hideStepUI(this.steps[previousIndex]);\n      }\n\n      this.currentStepIndex = index;\n      const step = this.steps[index];\n      const targetElement = this._getTargetElement(step.target);\n\n      if (!targetElement) {\n        console.warn(`[TourController] Target element not found for step ${index}:`, step.target);\n        if (this.currentStepIndex < this.steps.length - 1) this.next(); else this.end();\n        return;\n      }\n\n      if (step.onBeforeShow && step.onBeforeShow(step, index, this) === false) {\n        if (this.currentStepIndex < this.steps.length - 1) this.next(); else this.end();\n        return;\n      }\n\n      const popover = this._createOrGetPopover(step);\n      this.popoverElement = popover || undefined;\n      if (!this.popoverElement) {\n          this.end();\n          return;\n      }\n\n      this.popoverElement.style.display = 'block';\n      targetElement.scrollIntoView({ behavior: 'smooth', block: 'center', inline: 'center' });\n      this._applyHighlight(targetElement);\n\n      const middleware: Middleware[] = [\n        offsetMiddleware(step.offsetValue ?? this.options.defaultOffset),\n        inline(),\n        flip({ padding: this.options.padding }),\n        shift({ padding: this.options.padding }),\n        hide({ strategy: 'referenceHidden' }),\n        ...(step.middleware || [])\n      ];\n      if (this.arrowElement) {\n        middleware.push(arrowMiddleware({ element: this.arrowElement, padding: this.options.padding }));\n      }\n\n      const updatePosition = async () => {\n        if (!this.isActive || !targetElement.isConnected || !this.popoverElement || !this.popoverElement.isConnected) {\n          if (this.cleanupFloatingUI) this.cleanupFloatingUI();\n          return;\n        }\n\n        const pos = await computePosition(targetElement, this.popoverElement, {\n          placement: step.placement || this.options.defaultPlacement,\n          middleware: middleware,\n        });\n\n        this.popoverElement.style.left = `${pos.x}px`;\n        this.popoverElement.style.top = `${pos.y}px`;\n\n        if (pos.middlewareData.hide?.referenceHidden) {\n          this.popoverElement.style.visibility = 'hidden';\n        } else {\n          this.popoverElement.style.visibility = 'visible';\n        }\n\n        if (this.arrowElement && pos.middlewareData.arrow) {\n          const { x: arrowX, y: arrowY } = pos.middlewareData.arrow;\n          const staticSideMap: Record<string, string> = {\n            top: 'bottom', right: 'left', bottom: 'top', left: 'right',\n          };\n          const staticSide = staticSideMap[pos.placement.split('-')[0]];\n\n          Object.assign(this.arrowElement.style, {\n            left: arrowX != null ? `${arrowX}px` : '',\n            top: arrowY != null ? `${arrowY}px` : '',\n            right: '', bottom: '',\n            [staticSide]: `-${this.arrowElement.offsetHeight / 2}px`,\n          });\n        }\n      };\n\n      if (this.cleanupFloatingUI) this.cleanupFloatingUI();\n      this.cleanupFloatingUI = autoUpdate(targetElement, this.popoverElement, updatePosition, {\n          ancestorScroll: true, ancestorResize: true, elementResize: true, animationFrame: true\n      });\n\n      const currentStepForCallback = this.steps[this.currentStepIndex];\n      const actualOldStepForCallback = oldStepForCallback !== undefined ? oldStepForCallback : (previousIndex !== -1 && previousIndex !== index ? this.steps[previousIndex] : null);\n\n      if (this.currentStepIndex !== previousIndex || (actualOldStepForCallback && actualOldStepForCallback.id !== currentStepForCallback.id) ) {\n           this.options.onStepChange(currentStepForCallback, actualOldStepForCallback, this);\n      }\n      if (step.onAfterShow) step.onAfterShow(step, index, this);\n    }\n\n    private _applyHighlight(target: HTMLElement) {\n      if (!this.options.highlightTarget) return;\n\n      if (!this.highlightOverlay) {\n        this.highlightOverlay = document.createElement('div');\n        this.highlightOverlay.className = this.options.overlayClass;\n        this.highlightOverlay.style.position = 'fixed';\n        this.highlightOverlay.style.top = '0';\n        this.highlightOverlay.style.left = '0';\n        this.highlightOverlay.style.width = '100vw';\n        this.highlightOverlay.style.height = '100vh';\n        this.highlightOverlay.style.zIndex = '10000';\n        this.highlightOverlay.style.pointerEvents = 'none';\n        this.highlightOverlay.style.backgroundColor = this.options.overlayColor;\n        document.body.appendChild(this.highlightOverlay);\n      }\n      this.highlightOverlay.style.display = 'block';\n\n      if (!this.originalTargetStyles.has(target)) {\n        this.originalTargetStyles.set(target, {\n          position: target.style.position,\n          zIndex: target.style.zIndex,\n          boxShadow: target.style.boxShadow,\n\n        });\n      }\n\n      target.style.position = (target.style.position === 'static' || !target.style.position) ? 'relative' : target.style.position;\n      target.style.zIndex = '10001';\n      target.style.boxShadow = `0 0 0 9999px ${this.options.overlayColor}`; // Punch-hole\n      if (this.options.highlightClass) target.classList.add(this.options.highlightClass);\n    }\n\n    private _removeHighlight(target: HTMLElement | null) {\n      if (this.highlightOverlay) {\n        this.highlightOverlay.style.display = 'none';\n      }\n      if (target) {\n        const originalStyles = this.originalTargetStyles.get(target);\n        if (originalStyles) {\n          target.style.position = originalStyles.position || '';\n          target.style.zIndex = originalStyles.zIndex || '';\n          target.style.boxShadow = originalStyles.boxShadow || '';\n          this.originalTargetStyles.delete(target);\n        } else {\n          target.style.removeProperty('z-index');\n          target.style.removeProperty('box-shadow');\n        }\n        if (this.options.highlightClass) target.classList.remove(this.options.highlightClass);\n      }\n    }\n\n    private async _hideStepUI(step: TourStep, isEndingTour: boolean = false) {\n      if (step.onBeforeHide && step.onBeforeHide(step, this.currentStepIndex, this) === false && !isEndingTour) {\n        return;\n      }\n\n      if (this.cleanupFloatingUI) {\n        this.cleanupFloatingUI();\n        this.cleanupFloatingUI = undefined;\n      }\n\n      if (this.popoverElement) {\n        this.popoverElement.style.display = 'none';\n      }\n\n      const targetElement = this._getTargetElement(step.target);\n      this._removeHighlight(targetElement);\n\n      if (step.onAfterHide) step.onAfterHide(step, this.currentStepIndex, this);\n    }\n\n    public next() {\n      if (!this.isActive) return;\n      if (this.currentStepIndex < this.steps.length - 1) {\n        const oldStep = this.steps[this.currentStepIndex];\n        this._showStepOnTarget(this.currentStepIndex + 1, oldStep);\n      } else {\n        this.end();\n      }\n    }\n\n    public prev() {\n      if (!this.isActive) return;\n      if (this.currentStepIndex > 0) {\n        const oldStep = this.steps[this.currentStepIndex];\n        this._showStepOnTarget(this.currentStepIndex - 1, oldStep);\n      }\n    }\n\n    public jumpTo(stepIdOrIndex: string | number) {\n      if (!this.isActive) return;\n      const oldStep = this.currentStepIndex !== -1 ? this.steps[this.currentStepIndex] : null;\n      let newIndex = -1;\n      if (typeof stepIdOrIndex === 'number') {\n        newIndex = stepIdOrIndex;\n      } else {\n        newIndex = this.steps.findIndex(s => s.id === stepIdOrIndex);\n      }\n\n      if (newIndex !== -1 && newIndex !== this.currentStepIndex) {\n        this._showStepOnTarget(newIndex, oldStep);\n      } else if (newIndex === -1) {\n        console.warn(`[TourController] Step with ID or index \"${stepIdOrIndex}\" not found.`);\n      }\n    }\n\n    public end() {\n      if (!this.isActive) return;\n\n      const stepToHide = this.currentStepIndex !== -1 ? this.steps[this.currentStepIndex] : null;\n      if (stepToHide) {\n        this._hideStepUI(stepToHide, true);\n      }\n      const oldStepForCallback = stepToHide;\n\n\n      this.isActive = false;\n      this.currentStepIndex = -1;\n\n\n\n      if (this.options.renderPopover === this._defaultRenderPopover.bind(this) && this.popoverElement) {\n          this.popoverElement.remove();\n          this.popoverElement = undefined;\n          this.arrowElement = undefined;\n      } else if (this.popoverElement) {\n\n          this.popoverElement.style.display = 'none';\n      }\n\n      if (this.highlightOverlay) {\n        this.highlightOverlay.remove();\n        this.highlightOverlay = undefined;\n      }\n      this.originalTargetStyles.clear();\n\n\n      this.options.onTourEnd(this);\n\n      this.options.onStepChange(null, oldStepForCallback, this);\n    }\n\n    public updateOptions(newOptions: Partial<TourOptions>) {\n      this.options = { ...this.options, ...newOptions };\n      if (this.isActive && this.currentStepIndex !== -1) {\n        this._showStepOnTarget(this.currentStepIndex);\n      }\n    }\n  }\n","import { reactive, readonly, onUnmounted, ref, type Ref, type DeepReadonly } from 'vue';\nimport { TourController } from '../core/TourController';\nimport type { TourStepDefinition, TourOptions, TourStep, TourControllerPublic } from '../core/types';\n\ninterface TourReactiveState {\n  isActive: boolean;\n  currentStepIndex: number;\n  currentStep: TourStep | null;\n  totalSteps: number;\n}\n\nexport interface UseTourReturnType {\n  state: DeepReadonly<TourReactiveState>; // state will be a readonly version of TourReactiveState\n  defineSteps: (steps: TourStepDefinition[]) => void;\n  start: (index?: number) => void;\n  next: () => void;\n  prev: () => void;\n  jumpTo: (stepIdOrIndex: string | number) => void;\n  end: () => void;\n}\n\nlet tourInstanceRef: Ref<TourController | null> = ref(null);\n\nconst tourState = reactive<TourReactiveState>({\n  isActive: false,\n  currentStepIndex: -1,\n  currentStep: null,\n  totalSteps: 0,\n});\n\nexport function useTour(\n    initialSteps: TourStepDefinition[] = [],\n    options: TourOptions = {}\n): UseTourReturnType {\n  if (!tourInstanceRef.value) {\n    const mergedOptions: TourOptions = {\n      ...options,\n      onTourStart: (tour: TourControllerPublic) => {\n        tourState.isActive = true;\n        tourState.totalSteps = tour.steps.length;\n        options.onTourStart?.(tour);\n      },\n      onTourEnd: (tour: TourControllerPublic) => {\n        tourState.isActive = false;\n        tourState.currentStepIndex = -1;\n        tourState.currentStep = null;\n        options.onTourEnd?.(tour);\n      },\n      onStepChange: (newStep, oldStep, tour: TourControllerPublic) => {\n        tourState.currentStepIndex = tour.currentStepIndex;\n        tourState.currentStep = newStep;\n        tourState.totalSteps = tour.steps.length;\n        options.onStepChange?.(newStep, oldStep, tour);\n      },\n    };\n    tourInstanceRef.value = new TourController(initialSteps, mergedOptions);\n    tourState.isActive = tourInstanceRef.value.isActive;\n    tourState.currentStepIndex = tourInstanceRef.value.currentStepIndex;\n    tourState.currentStep = tourInstanceRef.value.currentStepIndex !== -1 ? tourInstanceRef.value.steps[tourInstanceRef.value.currentStepIndex] : null;\n    tourState.totalSteps = tourInstanceRef.value.steps.length;\n\n  } else {\n    tourInstanceRef.value.updateOptions(options);\n    if (initialSteps.length > 0 || (initialSteps.length === 0 && tourInstanceRef.value.steps.length > 0) ) {\n      tourInstanceRef.value.defineSteps(initialSteps);\n      tourState.totalSteps = tourInstanceRef.value.steps.length;\n    }\n  }\n\n  const defineSteps = (steps: TourStepDefinition[]) => {\n    tourInstanceRef.value?.defineSteps(steps);\n  };\n\n  const start = (index?: number) => tourInstanceRef.value?.start(index);\n  const next = () => tourInstanceRef.value?.next();\n  const prev = () => tourInstanceRef.value?.prev();\n  const end = () => tourInstanceRef.value?.end();\n  const jumpTo = (stepIdOrIndex: string | number) => tourInstanceRef.value?.jumpTo(stepIdOrIndex);\n\n  return {\n    state: readonly(tourState) as DeepReadonly<TourReactiveState>, // Cast for explicit return type matching\n    defineSteps,\n    start,\n    next,\n    prev,\n    jumpTo,\n    end,\n  };\n}\n"],"names":["generateId","TourController","steps","options","__publicField","target","e","step","actions","popover","arrowEl","titleEl","contentEl","contentValue","footerEl","prevButton","nextButton","finishButton","s","index","oldStep","oldStepForCallback","previousIndex","targetElement","middleware","offsetMiddleware","inline","flip","shift","hide","arrowMiddleware","updatePosition","pos","computePosition","_a","arrowX","arrowY","staticSide","autoUpdate","currentStepForCallback","actualOldStepForCallback","originalStyles","isEndingTour","stepIdOrIndex","newIndex","stepToHide","newOptions","tourInstanceRef","ref","tourState","reactive","useTour","initialSteps","mergedOptions","tour","newStep","defineSteps","start","next","prev","end","jumpTo","readonly"],"mappings":"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"}