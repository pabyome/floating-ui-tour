{"version":3,"file":"vue-floating-ui-tour.es.js","sources":["../src/core/utils.ts","../src/core/TourController.ts","../src/vue/useTour.ts"],"sourcesContent":["/**\n * Generates a simple unique ID string.\n * @returns\n */\nexport const generateId = (): string => `tour_step_${Math.random().toString(36).substring(2, 9)}`;\n","import {\n    computePosition,\n    autoUpdate,\n    offset as offsetMiddleware,\n    shift,\n    flip,\n    arrow as arrowMiddleware,\n    hide,\n    inline,\n    type Middleware,\n  } from '@floating-ui/dom';\n  import type { TourStepDefinition, TourStep, TourOptions, TourControllerPublic } from './types';\n  import { generateId } from './utils';\n\n  export class TourController implements TourControllerPublic {\n    public steps: TourStep[] = [];\n    public currentStepIndex: number = -1;\n    public isActive: boolean = false;\n\n    private options: Required<TourOptions>;\n    private popoverElement?: HTMLElement;\n    private arrowElement?: HTMLElement;\n    private cleanupFloatingUI?: () => void;\n    private highlightOverlay?: HTMLElement;\n    private originalTargetStyles: Map<HTMLElement, Partial<CSSStyleDeclaration>> = new Map();\n\n    constructor(steps: TourStepDefinition[] = [], options: TourOptions = {}) {\n      this.options = {\n        defaultPlacement: 'bottom',\n        defaultOffset: 10,\n        popoverClass: 'v-tour__popover',\n        arrowClass: 'v-tour__arrow',\n        padding: 8,\n        highlightTarget: true,\n        highlightClass: 'v-tour__highlighted-target',\n        overlayClass: 'v-tour__overlay',\n        overlayColor: 'rgba(0,0,0,0.3)',\n        onTourStart: () => {},\n        onTourEnd: () => {},\n        onStepChange: () => {},\n        renderPopover: this._defaultRenderPopover.bind(this),\n        ...options,\n      };\n      this.defineSteps(steps);\n    }\n\n    private _getTargetElement(target: string | HTMLElement): HTMLElement | null {\n      if (typeof target === 'string') {\n        try {\n          return document.querySelector(target);\n        } catch (e) {\n          console.error(`[TourController] Invalid selector: ${target}`, e);\n          return null;\n        }\n      }\n      return target;\n    }\n\n    private _createOrGetPopover(step: TourStep): HTMLElement | null {\n      const actions = {\n        next: () => this.next(),\n        prev: () => this.prev(),\n        finish: () => this.end(),\n      };\n      const popover = this.options.renderPopover(step, actions, this);\n\n      if (!popover || !(popover instanceof HTMLElement)) {\n        console.error(\"[TourController] renderPopover must return an HTMLElement.\");\n        return null;\n      }\n      this.popoverElement = popover;\n\n      if (!this.popoverElement.isConnected) {\n        document.body.appendChild(this.popoverElement);\n      }\n\n      if (this.options.arrowClass && this.popoverElement.classList.contains(this.options.popoverClass)) {\n          this.arrowElement = this.popoverElement.querySelector<HTMLElement>(`.${this.options.arrowClass}`) || undefined;\n      }\n      return this.popoverElement;\n    }\n\n    private _defaultRenderPopover(\n      step: TourStep,\n      actions: { next: () => void; prev: () => void; finish: () => void }\n    ): HTMLElement {\n\n      let popover = document.getElementById('v-tour-default-popover');\n      if (!popover) {\n          popover = document.createElement('div');\n          popover.id = 'v-tour-default-popover';\n          popover.className = this.options.popoverClass;\n          popover.style.position = 'absolute';\n          popover.style.zIndex = '10002';\n          popover.style.display = 'none';\n      }\n      popover.innerHTML = '';\n\n      if (this.options.arrowClass) {\n        const arrowEl = document.createElement('div');\n        arrowEl.className = this.options.arrowClass;\n        arrowEl.style.position = 'absolute';\n        popover.appendChild(arrowEl);\n        this.arrowElement = arrowEl;\n      } else {\n        this.arrowElement = undefined;\n      }\n\n      if (step.title) {\n        const titleEl = document.createElement('h3');\n        titleEl.className = 'v-tour__title';\n        titleEl.textContent = step.title;\n        popover.appendChild(titleEl);\n      }\n\n      const contentEl = document.createElement('div');\n      contentEl.className = 'v-tour__content';\n      const contentValue = typeof step.content === 'function'\n        ? step.content(step, this.currentStepIndex, this)\n        : step.content;\n      if (typeof contentValue === 'string') {\n          contentEl.innerHTML = contentValue;\n      } else if (contentValue instanceof HTMLElement) {\n          contentEl.appendChild(contentValue);\n      }\n      popover.appendChild(contentEl);\n\n      // Footer & Buttons\n      const footerEl = document.createElement('div');\n      footerEl.className = 'v-tour__footer';\n\n      if (this.currentStepIndex > 0) {\n        const prevButton = document.createElement('button');\n        prevButton.type = 'button';\n        prevButton.textContent = 'Previous';\n        prevButton.className = 'v-tour__button v-tour__button-prev';\n        prevButton.onclick = actions.prev;\n        footerEl.appendChild(prevButton);\n      }\n\n      if (this.currentStepIndex < this.steps.length - 1) {\n        const nextButton = document.createElement('button');\n        nextButton.type = 'button';\n        nextButton.textContent = 'Next';\n        nextButton.className = 'v-tour__button v-tour__button-next';\n        nextButton.onclick = actions.next;\n        footerEl.appendChild(nextButton);\n      }\n\n      const finishButton = document.createElement('button');\n      finishButton.type = 'button';\n      finishButton.textContent = this.currentStepIndex === this.steps.length - 1 ? 'Finish' : 'Close';\n      finishButton.className = 'v-tour__button v-tour__button-finish';\n      finishButton.onclick = actions.finish;\n      footerEl.appendChild(finishButton);\n\n      if (footerEl.hasChildNodes()) {\n          popover.appendChild(footerEl);\n      }\n      return popover;\n    }\n\n    public defineSteps(steps: TourStepDefinition[]) {\n      this.steps = steps.map((s) => ({ ...s, id: s.id || generateId() }));\n      if (this.isActive && this.currentStepIndex >= this.steps.length) {\n        this.end();\n      } else if (this.isActive && this.currentStepIndex !== -1) {\n        this._showStepOnTarget(this.currentStepIndex);\n      }\n    }\n\n    public start(index: number = 0) {\n      if (!this.steps.length) {\n        console.warn('[TourController] No steps defined.');\n        return;\n      }\n      this.isActive = true;\n      this.options.onTourStart(this);\n      const oldStep = this.currentStepIndex !== -1 ? this.steps[this.currentStepIndex] : null;\n      this.currentStepIndex = -1;\n      this._showStepOnTarget(index, oldStep);\n    }\n\n    private async _showStepOnTarget(index: number, oldStepForCallback: TourStep | null = null) {\n      if (index < 0 || index >= this.steps.length) {\n        this.end();\n        return;\n      }\n\n      const previousIndex = this.currentStepIndex;\n      if (previousIndex !== -1 && previousIndex !== index) {\n        await this._hideStepUI(this.steps[previousIndex]);\n      }\n\n      this.currentStepIndex = index;\n      const step = this.steps[index];\n      const targetElement = this._getTargetElement(step.target);\n\n      if (!targetElement) {\n        console.warn(`[TourController] Target element not found for step ${index}:`, step.target);\n        if (this.currentStepIndex < this.steps.length - 1) this.next(); else this.end();\n        return;\n      }\n\n      if (step.onBeforeShow && step.onBeforeShow(step, index, this) === false) {\n        if (this.currentStepIndex < this.steps.length - 1) this.next(); else this.end();\n        return;\n      }\n\n      const popover = this._createOrGetPopover(step);\n      this.popoverElement = popover || undefined;\n      if (!this.popoverElement) {\n          this.end();\n          return;\n      }\n\n      this.popoverElement.style.display = 'block';\n      targetElement.scrollIntoView({ behavior: 'smooth', block: 'center', inline: 'center' });\n      this._applyHighlight(targetElement);\n\n      const middleware: Middleware[] = [\n        offsetMiddleware(step.offsetValue ?? this.options.defaultOffset),\n        inline(),\n        flip({ padding: this.options.padding }),\n        shift({ padding: this.options.padding }),\n        hide({ strategy: 'referenceHidden' }),\n        ...(step.middleware || [])\n      ];\n      if (this.arrowElement) {\n        middleware.push(arrowMiddleware({ element: this.arrowElement, padding: this.options.padding }));\n      }\n\n      const updatePosition = async () => {\n        if (!this.isActive || !targetElement.isConnected || !this.popoverElement || !this.popoverElement.isConnected) {\n          if (this.cleanupFloatingUI) this.cleanupFloatingUI();\n          return;\n        }\n\n        const pos = await computePosition(targetElement, this.popoverElement, {\n          placement: step.placement || this.options.defaultPlacement,\n          middleware: middleware,\n        });\n\n        this.popoverElement.style.left = `${pos.x}px`;\n        this.popoverElement.style.top = `${pos.y}px`;\n\n        if (pos.middlewareData.hide?.referenceHidden) {\n          this.popoverElement.style.visibility = 'hidden';\n        } else {\n          this.popoverElement.style.visibility = 'visible';\n        }\n\n        if (this.arrowElement && pos.middlewareData.arrow) {\n          const { x: arrowX, y: arrowY } = pos.middlewareData.arrow;\n          const staticSideMap: Record<string, string> = {\n            top: 'bottom', right: 'left', bottom: 'top', left: 'right',\n          };\n          const staticSide = staticSideMap[pos.placement.split('-')[0]];\n\n          Object.assign(this.arrowElement.style, {\n            left: arrowX != null ? `${arrowX}px` : '',\n            top: arrowY != null ? `${arrowY}px` : '',\n            right: '', bottom: '',\n            [staticSide]: `-${this.arrowElement.offsetHeight / 2}px`,\n          });\n        }\n      };\n\n      if (this.cleanupFloatingUI) this.cleanupFloatingUI();\n      this.cleanupFloatingUI = autoUpdate(targetElement, this.popoverElement, updatePosition, {\n          ancestorScroll: true, ancestorResize: true, elementResize: true, animationFrame: true\n      });\n\n      const currentStepForCallback = this.steps[this.currentStepIndex];\n      const actualOldStepForCallback = oldStepForCallback !== undefined ? oldStepForCallback : (previousIndex !== -1 && previousIndex !== index ? this.steps[previousIndex] : null);\n\n      if (this.currentStepIndex !== previousIndex || (actualOldStepForCallback && actualOldStepForCallback.id !== currentStepForCallback.id) ) {\n           this.options.onStepChange(currentStepForCallback, actualOldStepForCallback, this);\n      }\n      if (step.onAfterShow) step.onAfterShow(step, index, this);\n    }\n\n    private _applyHighlight(target: HTMLElement) {\n      if (!this.options.highlightTarget) return;\n\n      if (!this.highlightOverlay) {\n        this.highlightOverlay = document.createElement('div');\n        this.highlightOverlay.className = this.options.overlayClass;\n        this.highlightOverlay.style.position = 'fixed';\n        this.highlightOverlay.style.top = '0';\n        this.highlightOverlay.style.left = '0';\n        this.highlightOverlay.style.width = '100vw';\n        this.highlightOverlay.style.height = '100vh';\n        this.highlightOverlay.style.zIndex = '10000';\n        this.highlightOverlay.style.pointerEvents = 'none';\n        this.highlightOverlay.style.backgroundColor = this.options.overlayColor;\n        document.body.appendChild(this.highlightOverlay);\n      }\n      this.highlightOverlay.style.display = 'block';\n\n      if (!this.originalTargetStyles.has(target)) {\n        this.originalTargetStyles.set(target, {\n          position: target.style.position,\n          zIndex: target.style.zIndex,\n          boxShadow: target.style.boxShadow,\n\n        });\n      }\n\n      target.style.position = (target.style.position === 'static' || !target.style.position) ? 'relative' : target.style.position;\n      target.style.zIndex = '10001';\n      target.style.boxShadow = `0 0 0 9999px ${this.options.overlayColor}`; // Punch-hole\n      if (this.options.highlightClass) target.classList.add(this.options.highlightClass);\n    }\n\n    private _removeHighlight(target: HTMLElement | null) {\n      if (this.highlightOverlay) {\n        this.highlightOverlay.style.display = 'none';\n      }\n      if (target) {\n        const originalStyles = this.originalTargetStyles.get(target);\n        if (originalStyles) {\n          target.style.position = originalStyles.position || '';\n          target.style.zIndex = originalStyles.zIndex || '';\n          target.style.boxShadow = originalStyles.boxShadow || '';\n          this.originalTargetStyles.delete(target);\n        } else {\n          target.style.removeProperty('z-index');\n          target.style.removeProperty('box-shadow');\n        }\n        if (this.options.highlightClass) target.classList.remove(this.options.highlightClass);\n      }\n    }\n\n    private async _hideStepUI(step: TourStep, isEndingTour: boolean = false) {\n      if (step.onBeforeHide && step.onBeforeHide(step, this.currentStepIndex, this) === false && !isEndingTour) {\n        return;\n      }\n\n      if (this.cleanupFloatingUI) {\n        this.cleanupFloatingUI();\n        this.cleanupFloatingUI = undefined;\n      }\n\n      if (this.popoverElement) {\n        this.popoverElement.style.display = 'none';\n      }\n\n      const targetElement = this._getTargetElement(step.target);\n      this._removeHighlight(targetElement);\n\n      if (step.onAfterHide) step.onAfterHide(step, this.currentStepIndex, this);\n    }\n\n    public next() {\n      if (!this.isActive) return;\n      if (this.currentStepIndex < this.steps.length - 1) {\n        const oldStep = this.steps[this.currentStepIndex];\n        this._showStepOnTarget(this.currentStepIndex + 1, oldStep);\n      } else {\n        this.end();\n      }\n    }\n\n    public prev() {\n      if (!this.isActive) return;\n      if (this.currentStepIndex > 0) {\n        const oldStep = this.steps[this.currentStepIndex];\n        this._showStepOnTarget(this.currentStepIndex - 1, oldStep);\n      }\n    }\n\n    public jumpTo(stepIdOrIndex: string | number) {\n      if (!this.isActive) return;\n      const oldStep = this.currentStepIndex !== -1 ? this.steps[this.currentStepIndex] : null;\n      let newIndex = -1;\n      if (typeof stepIdOrIndex === 'number') {\n        newIndex = stepIdOrIndex;\n      } else {\n        newIndex = this.steps.findIndex(s => s.id === stepIdOrIndex);\n      }\n\n      if (newIndex !== -1 && newIndex !== this.currentStepIndex) {\n        this._showStepOnTarget(newIndex, oldStep);\n      } else if (newIndex === -1) {\n        console.warn(`[TourController] Step with ID or index \"${stepIdOrIndex}\" not found.`);\n      }\n    }\n\n    public end() {\n      if (!this.isActive) return;\n\n      const stepToHide = this.currentStepIndex !== -1 ? this.steps[this.currentStepIndex] : null;\n      if (stepToHide) {\n        this._hideStepUI(stepToHide, true);\n      }\n      const oldStepForCallback = stepToHide;\n\n\n      this.isActive = false;\n      this.currentStepIndex = -1;\n\n\n\n      if (this.options.renderPopover === this._defaultRenderPopover.bind(this) && this.popoverElement) {\n          this.popoverElement.remove();\n          this.popoverElement = undefined;\n          this.arrowElement = undefined;\n      } else if (this.popoverElement) {\n\n          this.popoverElement.style.display = 'none';\n      }\n\n      if (this.highlightOverlay) {\n        this.highlightOverlay.remove();\n        this.highlightOverlay = undefined;\n      }\n      this.originalTargetStyles.clear();\n\n\n      this.options.onTourEnd(this);\n\n      this.options.onStepChange(null, oldStepForCallback, this);\n    }\n\n    public updateOptions(newOptions: Partial<TourOptions>) {\n      this.options = { ...this.options, ...newOptions };\n      if (this.isActive && this.currentStepIndex !== -1) {\n        this._showStepOnTarget(this.currentStepIndex);\n      }\n    }\n  }\n","import { reactive, readonly, onUnmounted, ref, type Ref, type DeepReadonly } from 'vue';\nimport { TourController } from '../core/TourController';\nimport type { TourStepDefinition, TourOptions, TourStep, TourControllerPublic } from '../core/types';\n\ninterface TourReactiveState {\n  isActive: boolean;\n  currentStepIndex: number;\n  currentStep: TourStep | null;\n  totalSteps: number;\n}\n\nexport interface UseTourReturnType {\n  state: DeepReadonly<TourReactiveState>; // state will be a readonly version of TourReactiveState\n  defineSteps: (steps: TourStepDefinition[]) => void;\n  start: (index?: number) => void;\n  next: () => void;\n  prev: () => void;\n  jumpTo: (stepIdOrIndex: string | number) => void;\n  end: () => void;\n}\n\nlet tourInstanceRef: Ref<TourController | null> = ref(null);\n\nconst tourState = reactive<TourReactiveState>({\n  isActive: false,\n  currentStepIndex: -1,\n  currentStep: null,\n  totalSteps: 0,\n});\n\nexport function useTour(\n    initialSteps: TourStepDefinition[] = [],\n    options: TourOptions = {}\n): UseTourReturnType {\n  if (!tourInstanceRef.value) {\n    const mergedOptions: TourOptions = {\n      ...options,\n      onTourStart: (tour: TourControllerPublic) => {\n        tourState.isActive = true;\n        tourState.totalSteps = tour.steps.length;\n        options.onTourStart?.(tour);\n      },\n      onTourEnd: (tour: TourControllerPublic) => {\n        tourState.isActive = false;\n        tourState.currentStepIndex = -1;\n        tourState.currentStep = null;\n        options.onTourEnd?.(tour);\n      },\n      onStepChange: (newStep, oldStep, tour: TourControllerPublic) => {\n        tourState.currentStepIndex = tour.currentStepIndex;\n        tourState.currentStep = newStep;\n        tourState.totalSteps = tour.steps.length;\n        options.onStepChange?.(newStep, oldStep, tour);\n      },\n    };\n    tourInstanceRef.value = new TourController(initialSteps, mergedOptions);\n    tourState.isActive = tourInstanceRef.value.isActive;\n    tourState.currentStepIndex = tourInstanceRef.value.currentStepIndex;\n    tourState.currentStep = tourInstanceRef.value.currentStepIndex !== -1 ? tourInstanceRef.value.steps[tourInstanceRef.value.currentStepIndex] : null;\n    tourState.totalSteps = tourInstanceRef.value.steps.length;\n\n  } else {\n    tourInstanceRef.value.updateOptions(options);\n    if (initialSteps.length > 0 || (initialSteps.length === 0 && tourInstanceRef.value.steps.length > 0) ) {\n      tourInstanceRef.value.defineSteps(initialSteps);\n      tourState.totalSteps = tourInstanceRef.value.steps.length;\n    }\n  }\n\n  const defineSteps = (steps: TourStepDefinition[]) => {\n    tourInstanceRef.value?.defineSteps(steps);\n  };\n\n  const start = (index?: number) => tourInstanceRef.value?.start(index);\n  const next = () => tourInstanceRef.value?.next();\n  const prev = () => tourInstanceRef.value?.prev();\n  const end = () => tourInstanceRef.value?.end();\n  const jumpTo = (stepIdOrIndex: string | number) => tourInstanceRef.value?.jumpTo(stepIdOrIndex);\n\n  return {\n    state: readonly(tourState) as DeepReadonly<TourReactiveState>, // Cast for explicit return type matching\n    defineSteps,\n    start,\n    next,\n    prev,\n    jumpTo,\n    end,\n  };\n}\n"],"names":["generateId","TourController","steps","options","__publicField","target","e","step","actions","popover","arrowEl","titleEl","contentEl","contentValue","footerEl","prevButton","nextButton","finishButton","index","oldStep","oldStepForCallback","previousIndex","targetElement","middleware","offsetMiddleware","inline","flip","shift","hide","arrowMiddleware","updatePosition","pos","computePosition","_a","arrowX","arrowY","staticSide","autoUpdate","currentStepForCallback","actualOldStepForCallback","originalStyles","isEndingTour","stepIdOrIndex","newIndex","s","stepToHide","newOptions","tourInstanceRef","ref","tourState","reactive","useTour","initialSteps","mergedOptions","tour","newStep","defineSteps","start","next","prev","end","jumpTo","readonly"],"mappings":"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"}